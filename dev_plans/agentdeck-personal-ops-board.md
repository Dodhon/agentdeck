# AgentDeck (personal ops board + agent control surface)

0) Executive Summary (5–10 lines)
Objective: design and build a local-first “personal ops board” that consolidates priorities and provides a safe control surface for OpenClaw agent coordination. Decision needed: confirm scope (dashboard-only vs dashboard+agent control), UI type (web app vs TUI), and storage (SQLite vs JSON) by **2026-02-03**. Problem: daily priorities are scattered across cron outputs, repo briefs, mission_control, and memory files, and agent control lacks a single, inspectable interface. Proposal: add a local dashboard that ingests existing artifacts (briefly outputs, mission_control, memory clarifications) and adds explicit agent-control actions (list sessions, view status, send commands) with audit-friendly snapshots. Benefits: faster daily startup, fewer dropped follow-ups, and a predictable way to coordinate multiple OpenClaw agents. Ask: approve the plan and the chosen storage/interface so we can implement the Core PR.

1) End‑user context
- Primary user: Thupten (technical, prefers concise, autonomous assistance).
- Goals: quick daily situational awareness, a single prioritized queue, and controlled agent coordination.
- Constraints: local-only data; no external posting without permission; minimal maintenance; fast refresh.

2) Requirements `R1..Rn`
**User requirements**
- UR1: One screen that shows today’s priorities, upcoming calendar items, and repo activity signals.
- UR2: Ability to mark an item as “next” or “done” without opening multiple tools.
- UR3: A daily snapshot that can be referenced later (what was the plan vs what happened).
- UR4: A safe, explicit panel to coordinate OpenClaw agents (list sessions, send tasks, view outcomes).

**Functional requirements**
- R1: Ingest repo signals from `scripts/briefly_run.sh` outputs for VMRS + Clipping (and optionally other repos).
- R2: Ingest mission_control status from `mission_control/tasks.json` and `WORKING.md`.
- R3: Ingest memory clarifications from `memory/memory-clarifications.md`.
- R4: Provide a unified “Today” view: top priorities, next task, and blockers.
- R5: Provide a lightweight status update mechanism (mark done / defer / focus).
- R6: Persist daily snapshots (date-stamped) for auditability.
- R7: Provide agent control actions: list active sessions, view last messages, send a structured task message, and record the action in the daily snapshot.

**Non‑functional requirements**
- NFR1: Local-only storage; no external APIs required for core functionality.
- NFR2: Dashboard loads in <= 2 seconds on local machine.
- NFR3: Low maintenance (no background daemons required; cron optional).
- NFR4: Data refresh is deterministic and idempotent.
- NFR5: Agent control is explicit and auditable (every action logged).

**Goals**
- G1: Reduce daily startup time to < 5 minutes.
- G2: Increase follow-through on “next task” decisions (proxy via daily snapshot).
- G3: Centralize “what changed” across repos into one view.
- G4: Provide a predictable, safe way to route work to multiple agents.

3) Non‑goals
- NG1: No automatic email or calendar writing.
- NG2: No multi-user collaboration.
- NG3: No cloud sync (for initial version).
- NG4: No replacement for mission_control; only a read/write convenience layer.
- NG5: No autonomous agent execution without explicit user-triggered actions.

4) Success metrics (quantified)
- SM1: Dashboard loads in <= 2 seconds (measured locally).
- SM2: Daily snapshot generated for >= 6/7 days per week.
- SM3: At least 80% of “next task” selections are marked done or explicitly deferred by day end.
- SM4: Zero manual edits required to compile the daily view (all from existing files + minimal UI actions).
- SM5: 100% of agent actions are logged with timestamp + target session.

5) Current repo state (repo‑grounded)
- Repo briefs are generated by `scripts/briefly_run.sh` and stored under `briefly/briefs_out/` in the clawd workspace.
- Task status exists in `mission_control/tasks.json` and `mission_control/WORKING.md` in the clawd workspace.
- Memory clarifications live in `memory/memory-clarifications.md` in the clawd workspace.
- AgentDeck repo is empty (newly created). No existing UI/dashboard.

6) Architecture/system impact diagram (ASCII)
```
Local files (sources)                        OpenClaw control
  ├─ briefly/briefs_out/*.md                 ├─ sessions_list
  ├─ mission_control/tasks.json              ├─ sessions_history
  ├─ mission_control/WORKING.md              └─ sessions_send
  └─ memory/memory-clarifications.md
            │                                          │
            └──────────────┐                           │
                           ▼                           ▼
                    Ingestion/Normalizer        Agent Action Layer
                           │                           │
                           └──────────────┐            │
                                          ▼            ▼
                                   Local store (SQLite/JSON)
                                          │
                                          ▼
                              Local UI (Today/Next/Done + Agents)
```

7) Assumptions & constraints
- REPO_ROOT assumed at `/Users/thuptenwangpo/clawd` for the source artifacts; AgentDeck must support configuring source paths.
- Data directories are readable and writable by the app. Daily snapshots should be created under `reports/ops-board/` (new directory) or similar.
- No external APIs required for core functionality. Optional cron-based refresh can be added later.
- ID generation: UUIDv4 for dashboard items if not already present in source data.
- Minimal error states: if a source file is missing, show a warning card but render the rest of the dashboard.
- Agent actions must be explicit user-triggered; no background agent execution.

8) Work breakdown `E1..En` mapping to `R*`
- E1 (R1–R4): Define ingestion schema + normalization rules (briefs, mission_control, memory clarifications).
  - Artifacts: `ops_board/schema.md` (or similar), normalizer module.
  - Owner: TBD. Window: by 2026-02-05.
- E2 (R5–R6): Implement local storage + daily snapshot writer.
  - Artifacts: storage module, `reports/ops-board/YYYY-MM-DD.json` snapshots.
  - Owner: TBD. Window: by 2026-02-06.
- E3 (R4–R5): Build dashboard UI (Today/Next/Done), minimal actions.
  - Artifacts: UI pages/components, local API routes (if web app).
  - Owner: TBD. Window: by 2026-02-08.
- E4 (R7, NFR5): Add agent control surface (sessions list/history/send), plus audit logging.
  - Artifacts: agent actions module, audit log entries in snapshots.
  - Owner: TBD. Window: by 2026-02-09.
- E5 (NFR2–NFR4): Add refresh/validation routines and performance checks.
  - Artifacts: validation script + README instructions.
  - Owner: TBD. Window: by 2026-02-10.

9) Validation plan `V1..Vn` mapping to `R*` + success metrics
- V1 (R1–R3, SM4): Run ingestion on existing files and confirm parsed counts.
  - Command: `node ops_board/scripts/ingest.js --dry-run` (or equivalent).
  - Pass if: counts match file contents; warnings only for missing files.
- V2 (R4, SM1): Load dashboard and measure render time.
  - Pass if: initial load <= 2 seconds.
- V3 (R5–R6, SM2): Mark an item as done and confirm snapshot contains the change.
  - Pass if: snapshot file created for today and reflects updated status.
- V4 (R7, SM5): Trigger an agent action and confirm audit entry.
  - Pass if: snapshot includes action with session id + timestamp.
- V5 (NFR4): Re-run ingestion twice in a row.
  - Pass if: no duplicate items, same IDs preserved.

10) Risks & mitigations
- Risk: Source data formats change (briefly output or mission_control schema).
  - Mitigation: versioned parsers + schema validation with fallbacks.
- Risk: Overloading the dashboard with low-signal items.
  - Mitigation: rules for top-N items and explicit “show more.”
- Risk: UI maintenance creep.
  - Mitigation: minimal UI scope; focus on “Today/Next/Done + Agents.”
- Risk: Agent actions executed without sufficient context.
  - Mitigation: require explicit user-trigger + confirmation dialog for sends.

11) Top 10 reader questions (with answers or explicit follow‑up)
1. Why not just use mission_control? → This consolidates multiple sources and adds a daily snapshot view.
2. Will it require constant setup? → No; it reads existing files with minimal manual input.
3. How will priorities be ranked? → Deterministic heuristic (recent repo activity + open tasks + memory clarifications) with manual override.
4. What’s the storage choice? → TBD (SQLite for queries vs JSON for simplicity).
5. What if a source file is missing? → Show a warning; continue rendering other data.
6. How do I mark tasks done? → Inline action that updates local store + snapshot.
7. Can it integrate calendar/email? → Not in core scope; optional follow-up.
8. Where are snapshots stored? → `reports/ops-board/` in the repo.
9. Will this replace current cron briefs? → No; it consumes them.
10. How portable is it? → Local-first; can be moved with the repo.

12) Open questions (answered)
- Storage: **SQLite** (default). Rationale: enables filtering/history and avoids manual JSON stitching.
- UI: **Local web app** (default). Rationale: fastest iteration and most usable control surface.
- Ingestion trigger: **On demand** (default) with optional cron later. Rationale: avoid background daemons for v1.
- Agent action confirmation: **Yes, required** by default. Rationale: explicit control + auditability.

13) Core PR vs Optional follow‑ups
**Core PR (must‑do)**
- Define ingestion schema + normalization rules.
- Implement local storage and daily snapshot writer.
- Build minimal UI with Today/Next/Done and basic actions.
- Add agent control surface (sessions list/history/send) with audit logging.
- Add validation scripts + README instructions.

**Optional follow‑ups**
- Calendar/email read-only integrations.
- Notifications for deadlines (local only).
- Trend view (weekly “done vs planned”).

14) Recommendation
- Start with a **local web app** for fast iteration and visual clarity.
- Use **SQLite** if you want query flexibility (filters/history); use **JSON** if simplicity is the top priority. Recommendation: SQLite for long-term usefulness.
- Keep agent control actions explicit and auditable from day one.

15) Next steps
- Thupten: confirm storage choice (SQLite vs JSON) and UI choice (web app vs TUI) by **2026-02-03**.
- Clawd: once confirmed, draft the initial scaffold and ingestion modules (Core PR).

## Issue seeding (ready to create GH issues without extra context)
Use the following issues verbatim. Each issue includes acceptance criteria and mapping to requirements.

1) **Issue: Define ingestion schema + normalizers**
- **Summary**: Define the canonical schema for “Today” items and implement parsers for briefly output, mission_control, and memory clarifications.
- **Reqs**: R1–R4
- **Acceptance criteria**:
  - Schema doc exists (fields, types, required/optional).
  - Parsers extract items from the three sources.
  - Dry-run ingest reports counts and missing-file warnings.

2) **Issue: Storage + daily snapshot writer**
- **Summary**: Implement the persistence layer and daily snapshot export.
- **Reqs**: R5–R6, NFR4
- **Acceptance criteria**:
  - Data store supports create/update for items and actions.
  - Daily snapshot file created at `reports/ops-board/YYYY-MM-DD.json` (or equivalent).
  - Re-running ingest does not create duplicates (idempotent IDs).

3) **Issue: Minimal dashboard UI (Today/Next/Done)**
- **Summary**: Build the core UI for viewing and updating items.
- **Reqs**: R4–R5, NFR2
- **Acceptance criteria**:
  - UI shows Today list, Next item, Done list.
  - User can mark an item “next” or “done.”
  - Page loads <= 2 seconds in local dev.

4) **Issue: Agent control surface + audit logging**
- **Summary**: Provide session list/history and send task action; log actions to snapshot.
- **Reqs**: R7, NFR5
- **Acceptance criteria**:
  - UI lists active sessions with last message summary.
  - UI can send a task message to a selected session.
  - Snapshot logs each action with timestamp + session id.

5) **Issue: Validation + README**
- **Summary**: Add validation scripts and document setup/usage.
- **Reqs**: NFR2–NFR4
- **Acceptance criteria**:
  - Validation script runs ingestion dry-run and basic checks.
  - README documents setup, source paths, and how to run the UI.

## Ready for Execution
- [ ] Storage choice confirmed (SQLite vs JSON).
- [ ] UI choice confirmed (web app vs TUI).
- [ ] Snapshot location confirmed (`reports/ops-board/`).
- [ ] Ingestion sources finalized (briefly + mission_control + memory clarifications).
- [ ] Agent action confirmation behavior decided.

## Best‑practice references
- SQLite documentation: https://www.sqlite.org/docs.html
- Next.js App Router docs: https://nextjs.org/docs/app
- React docs: https://react.dev/learn
- Node.js File System API: https://nodejs.org/api/fs.html
- JSON schema (RFC 8259): https://www.rfc-editor.org/rfc/rfc8259
